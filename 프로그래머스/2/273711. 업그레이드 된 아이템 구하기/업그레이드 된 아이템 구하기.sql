-- 코드를 작성해주세요
WITH 
NEW_DATA AS(
SELECT
*
FROM ITEM_INFO
WHERE RARITY = "RARE"
),
ITEMS AS (
SELECT
T.ITEM_ID
FROM ITEM_TREE T
INNER JOIN NEW_DATA N
ON T.PARENT_ITEM_ID = N.ITEM_ID
)

SELECT
I.ITEM_ID,
I.ITEM_NAME,
I.RARITY
FROM ITEM_INFO I
INNER JOIN ITEMS ITEMS
ON I.ITEM_ID = ITEMS.ITEM_ID
ORDER BY I.ITEM_ID DESC